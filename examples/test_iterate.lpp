// Test Iterate-While Operators
// Three syntax styles: Symbolic, Haskell-style (via stdlib), JavaScript-style (via stdlib)

fn test_symbolic_golf() -> void {
    print("=== Symbolic Golf-Style ===");
    
    // Auto-iterate operators
    let count_up = 0 !!< 10;        // [0,1,2,3,4,5,6,7,8,9]
    let count_down = 10 !!> 0;      // [10,9,8,7,6,5,4,3,2,1]
    
    print("Count up 0 !!< 10:");
    print(count_up);
    print("Count down 10 !!> 0:");
    print(count_down);
    
    // Iterate-while with condition and step
    let evens = 0 !! (x -> x < 20) $ (x -> x + 2);
    print("Evens 0 !! (x < 20) $ (x + 2):");
    print(evens);
    
    // Iterate-step alternative syntax
    let powers = 1 ~> (x -> x * 2) !! (x -> x < 1000);
    print("Powers of 2: 1 ~> (x*2) !! (x < 1000):");
    print(powers);
}

fn test_fibonacci() -> void {
    print("=== Fibonacci with Iterate-While ===");
    
    // Generate fibonacci sequence using iterate-while
    // Each step returns [fib(n), fib(n+1)]
    let fib_pairs = [0, 1] !! (pair -> pair[1] < 100) $ (pair -> [pair[1], pair[0] + pair[1]]);
    
    // Extract just the fibonacci numbers
    let fibs = fib_pairs @ (pair -> pair[0]);
    print("Fibonacci < 100:");
    print(fibs);
}

fn test_collatz() -> void {
    print("=== Simple Countdown ===");
    
    // Simple countdown from 10 to 1
    let countdown = 10 !! (n -> n > 0) $ (n -> n - 1);
    print("Countdown from 10:");
    print(countdown);
}

fn test_composition() -> void {
    print("=== Combining Operators ===");
    
    // Generate squares of even numbers up to 20
    let result = (0 !!< 10) @ (x -> x * 2) @ (x -> x * x);
    print("Squares of evens 0-9:");
    print(result);
    
    // Sum using reduce
    let sum = result \ ((acc, x) -> acc + x);
    print("Sum:");
    print(sum);
}

fn main() -> int {
    test_symbolic_golf();
    print("");
    
    test_fibonacci();
    print("");
    
    test_collatz();
    print("");
    
    test_composition();
    
    return 0;
}
